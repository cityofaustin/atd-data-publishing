import data_helpers

old = [{u'CONTROL': u'SLAVE', u'MODIFIED_DATE': u'2016-11-09T00:00:00', u'COUNCIL_DISTRICT': u'4', u'PRIMARY_ST_SEGMENT_ID': u'3259893', u'LOCATION_NAME': u'E ANDERSON LN SVRD EB / CAMERON RD ', u'PRIMARY_ST_AKA': u'US 183 EB SVRD', u'LOCATION': {u'latitude': u'30.332219', u'needs_recoding': False, u'longitude': u'-97.686614'}, u'COA_INTERSECTION_ID': u'5163428', u'ATD_LOCATION_ID': u'1516', u'JURISDICTION': u'AUSTIN FULL PURPOSE', u'SIGNAL_STATUS': u'TURNED_ON', u'TURN_ON_DATE': u'2016-11-09T00:00:00', u'SIGNAL_ENG_AREA': u'NORTH', u'CROSS_ST_SEGMENT_ID': u'3267755', u'PRIMARY_ST': u'E ANDERSON LN SVRD EB', u'CROSS_ST': u'CAMERON RD', u'SIGNAL_TYPE': u'TRAFFIC', u'MASTER_SIGNAL_ID': u'937', u'SWITCH_COMM': u'N/A', u'ATD_SIGNAL_ID': u'931'},{u'CONTROL': u'SLAVE', u'MODIFIED_DATE': u'2016-11-09T00:00:00', u'COUNCIL_DISTRICT': u'4', u'PRIMARY_ST_SEGMENT_ID': u'3259893', u'LOCATION_NAME': u'E ANDERSON LN SVRD EB / CAMERON RD ', u'PRIMARY_ST_AKA': u'US 183 EB SVRD', u'LOCATION': {u'latitude': u'30.332219', u'needs_recoding': False, u'longitude': u'-97.686614'}, u'COA_INTERSECTION_ID': u'5163428', u'ATD_LOCATION_ID': u'1516', u'JURISDICTION': u'AUSTIN FULL PURPOSE', u'SIGNAL_STATUS': u'TURNED_ON', u'TURN_ON_DATE': u'2016-11-09T00:00:00', u'SIGNAL_ENG_AREA': u'NORTH', u'CROSS_ST_SEGMENT_ID': u'3267755', u'PRIMARY_ST': u'E ANDERSON LN SVRD EB', u'CROSS_ST': u'CAMERON RD', u'SIGNAL_TYPE': u'TRAFFIC', u'MASTER_SIGNAL_ID': u'937', u'SWITCH_COMM': u'N/A', u'ATD_SIGNAL_ID': u'932'}]


new = [{u'CROSS_ST_SEGMENT_ID': '3267755', u'ATD_LOCATION_ID': '1516', u'CROSS_ST': 'CAMERON RD', 'IP_SWITCH': '', u'CONTROL': 'SLAVE', u'MODIFIED_DATE': '11/09/2016', u'LOCATION_NAME': 'E ANDERSON LN SVRD EB / CAMERON RD ', u'PRIMARY_ST_AKA': 'US 183 EB SVRD', 'LANDMARK': '', u'MASTER_SIGNAL_ID': '937', u'JURISDICTION': 'AUSTIN FULL PURPOSE', u'SIGNAL_STATUS': 'TURNED_ON', u'PRIMARY_ST_SEGMENT_ID': '3259893', u'COA_INTERSECTION_ID': '5163428', 'LONGITUDE': ' -97.686614', u'SIGNAL_TYPE': 'TRAFFIC', u'SIGNAL_ENG_AREA': 'NORTH', u'PRIMARY_ST': 'E ANDERSON LN SVRD EB', 'IP_CONTROL': '', 'TRAFFIC_ENG_AREA': '', u'COUNCIL_DISTRICT': '4', 'CROSS_ST_AKA': '', u'TURN_ON_DATE': '11/09/2016', 'COMM_PLAN': '', 'LATITUDE': '30.332219', u'SWITCH_COMM': 'N/A', u'ATD_SIGNAL_ID': '931'},{u'CONTROL': u'SLAVE', u'MODIFIED_DATE': u'2016-11-09T00:00:00', u'COUNCIL_DISTRICT': u'4', u'PRIMARY_ST_SEGMENT_ID': u'3259893', u'LOCATION_NAME': u'E ANDERSON LN SVRD EB / CAMERON RD ', u'PRIMARY_ST_AKA': u'US 183 EB SVRD', u'LOCATION': {u'latitude': u'30.332219', u'needs_recoding': False, u'longitude': u'-97.686614'}, u'COA_INTERSECTION_ID': u'5163428', u'ATD_LOCATION_ID': u'1516', u'JURISDICTION': u'AUSTIN FULL PURPOSE', u'SIGNAL_STATUS': u'TURNED_ON', u'TURN_ON_DATE': u'2016-11-09T00:00:00', u'SIGNAL_ENG_AREA': u'NORTH', u'CROSS_ST_SEGMENT_ID': u'3267755', u'PRIMARY_ST': u'E ANDERSON LN SVRD EB', u'CROSS_ST': u'CAMERON RD', u'SIGNAL_TYPE': u'TRAFFIC', u'MASTER_SIGNAL_ID': u'937', u'SWITCH_COMM': u'N/A', u'ATD_SIGNAL_ID': u'934'}]


res = data_helpers.DetectChanges(old, new, 'ATD_SIGNAL_ID')

